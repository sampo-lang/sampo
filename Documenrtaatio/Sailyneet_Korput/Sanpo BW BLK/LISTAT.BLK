                                              >5.3.86-HPU                                                                             L      I   SSSS                                                 L      I   S   S                                                L      I    S                                                   L      I     S                                                  L      I      S                                                 L      I   S   S                                                LLLLL  I    SSSS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \ Listojen latausruutu                        20.4.86-HPU                                                                       CR .( LISTAT ALKAVAT)                                                                                                           1 42 +THRU                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \ Listan ja alkion tulostys joko puskuriin    >17.3.86-HPU      \ tai ruudulle                                                  HEX                                                             VARIABLE BUFF-EMIT      VARIABLE BUPO                                                                                           : BUF!                                                            BUPO @ C! 1 BUPO +! ;                                                                                                         : LEMIT                                                           BUFF-EMIT @ IF   BUF!                                                       ELSE EMIT THEN                                    ;                                                               : LTYPE                                                           BUFF-EMIT @ IF 0 ?DO COUNT BUF! LOOP DROP                                   ELSE TYPE THEN                                    ; DECIMAL                                                       \ HEAP HEADER AND FIELDS = PCB                                  : POOL                          ( SIZE , ---  MAARITTELYSSA )     CREATE HERE 6 +               ( ---  , PCB SUORITUKSESSA)       1 , DUP ,                                                       OVER OVER + , OVER ALLOT                                        SWAP 0 FILL                                                     256 ALLOT   DOES> ;           \ SUOJA-ALUE                    : POBEG                         ( PCB , ADDR OF BEGPOOL )         2+ @ ;                                                                                                                        : POEND                         ( PCB , ADDR OF ENDPOOL )         4 + @ ;                                                                                       \ PCB , ADR OF ACTIVE POINT     : ACTIVE                        \ KORJAA LIS @ :TI{               DUP @ 1 AND OVER +! DUP @                                       SWAP POBEG + ;                                                \ edetaan poolia, kierretaan alkuun, jos t    28.3.86-HPU                                                                       VARIABLE OFLO           VARIABLE XPCB                                                                                           : CYCLE                                 ( PCB , - )               OFLO @                                                          IF                                                                  XPCB @ DUP POBEG SWAP                                           DUP POEND SWAP POBEG                                            - ABS 0 FILL                                                    ." LISTA-ALUE TYHJENNETTY " WARM                                0 OFLO !                                                    ELSE                                                               1 OFLO !                                                     THEN 1 XPCB @ !                                               ;                                                               \ Avustavia rutiineita                        2.4.86-HPU                                                                        : ONKO-OFLO                                                       XPCB @ ACTIVE                                                   XPCB @ POEND                                                    U> IF CYCLE THEN                                              ;                                                                                                                               : MAKE-EVEN                                                       [COMPILE] EVEN                                                ;                                                                                                                               : !+                                                              OVER @                                                          + SWAP !                                                      ;                                                               \ etsitaan halutun pituinen vapaa alue        2.4.86-HPU                                                                        : GETN                          ( PCB n , --- )                   MAKE-EVEN >R XPCB ! 0 OFLO !                                    BEGIN                                                                 XPCB @ ACTIVE                                                   XPCB @ POEND OVER -                                             0 SCAN                                                          IF      XPCB @ POBEG -                                                  XPCB @ ! XPCB @ ACTIVE R@ 0 SKIP                                IF      XPCB @ POBEG -                                                  XPCB @ ! ONKO-OFLO 0                                    ELSE DROP 1 THEN                                        ELSE DROP CYCLE 0 THEN                                     UNTIL                                                           R> DROP ;                                                    \ Apusanoja                                                     VARIABLE STRI 4 ALLOT                                           VARIABLE LIS  4 ALLOT           \ Toinen header STRIIN )                                                                        : 1+!                           \ ADDR , --- )                    DUP @ 1+ SWAP ! ;                                                                                                             : 1-!                           \ ADDR , --- )                    DUP @ 1- SWAP ! ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ Etsitaan vapaa node, linkitys jos tarpee    2.4.86-HPU        HEX                                                             : LINKITA                                                         LIS @  2 -            \ MIHIN PIT{ISI TULLA                     LIS 4 GETN                                                      4000 OR                                                         LIS ACTIVE !          \ LINKIN SIJOITUSPAIKKA                   LIS @ 2+ LIS !        \ VAPAA SANA (MUISTA 4 GETN)            ;                                                                                                                               : NEXTLIS                       \ --- , --- )                     LIS ACTIVE @                                                    IF LINKITA THEN               \ EI VAPAA JOTEN LINKIT{        ;                                                               DECIMAL                                                                                                                         \ Alkio pooliin                               >24.2.86-HPU                                                                      VARIABLE LEVEL 0 LEVEL !                                                                                                        : ALKUSULKU                                                       LEVEL 1+! 0 ;                                                                                                                 : ALKIO                         \ --- , OFFSET IN POOL )          STRI HERE C@ 1+ GETN                                            HERE STRI ACTIVE                                                HERE C@ 1+ CMOVE                                                STRI @                                                          HERE C@ 1+ STRI +!                                            ;                                                               : " 32 WORD ALKIO SWAP DROP 4 STATE @ IF                            [COMPILE] DLITERAL THEN ; IMMEDIATE                         \ Loppusulkku ja listan purku pooliin         >17.3.86-HPU      HEX VARIABLE $KPL                                               : LOPPUSULKU            \ 0 OFF OFF ... , OFF )                   0 $KPL !                                                        BEGIN                                                             -DUP WHILE                                                      NEXTLIS LIS ACTIVE !                                            LIS @ 2+ LIS !                                                  $KPL 1+!                                                      REPEAT $KPL @ IF              \ Jos nollalista, ei tilaa                        NEXTLIS                                                         $KPL @ 8000 OR LIS ACTIVE !                                     LIS @ DUP 2+ LIS !                                            ELSE 0 THEN                                       8000 OR LEVEL 1-!                                             ;                                                               \ Seuraava listan alkio sita lapikaytaessa                      : KULJE                             \ LINKKIOFF , OFF             LIS POBEG + @ 3FFF AND                                        ;                                                               : SEURAAVA                              \ OFF , OFF               2- BEGIN                                                             DUP LIS POBEG +                                                 @ 4000 AND                       | OFF FLAG                   WHILE KULJE REPEAT                                         ;                                                               : .STRING                               \ OFF , ---               -DUP IF STRI POBEG +                                                    DUP 1+ SWAP C@ LTYPE 20 LEMIT                                ELSE ASCII N LEMIT ASCII I LEMIT ASCII L LEMIT 20 LEMIT         THEN                                                     ;                                                               \ Listan tulostus, rekursiivinen              >17.3.86-HPU                                                                      DEFER TULOSTA                                                   : (.LIST)                                                         DUP LIS POBEG +                                                 @ 7FFF AND                                                      -DUP IF 0 ?DO                                                            SEURAAVA DUP                                                    LIS POBEG + @                                                   TULOSTA                                                     LOOP                                                       ENDIF                                                         ;                                                               : .LIST                                                            ASCII ( LEMIT 20 LEMIT DUP IF (.LIST) THEN   \ OFF , -          ASCII ) LEMIT 20 LEMIT DROP ;                                \ Tulostus, rekursiivinen                     >5.3.86-HPU       : TUL                                  \ OFF , --- )              DUP 8000 AND                                                    IF                                                                 7FFF AND .LIST                                               ELSE                                                               .STRING                                                     ENDIF ;                                                                                                                        ' TUL IS TULOSTA                                                : .$                                    \ TYPE OFF , --- )             JOS  1 NIIN TUL     LOPPUUN                                          4 NIIN .STRING LOPPUUN                                     ELLEI ." PINON PAA EI LISTA TAI ALKIO " LOPPU            ;                                                                                                                               \ Mika sanatyyppi on HERE:ssa                 20.2.86-HPUU      DECIMAL                                                         : YKSIMERKKI                                                         JOS HERE  1+ C@                                                     ASCII ( NIIN 0 LOPPUUN                                          ASCII ) NIIN 2 LOPPUUN                                                 ELLEI 1                                              LOPPU ;                                                    : MIKA                                                            HERE C@ 1 = IF YKSIMERKKI                                                   ELSE 1                                                          ENDIF                                             ;                                                               : GETWORD BEGIN                                                   32 WORD C@ 0 = WHILE ."  ***JATKA" CR QUERY REPEAT            ;                                                               \ Sulku on nyt listan aloitus, joten komme    >24.2.86-HPU      : SANANEN                                                           GETWORD JOS MIKA                                                            0 NIIN ALKUSULKU  LOPPUUN                                       1 NIIN ALKIO      LOPPUUN                                       2 NIIN LOPPUSULKU LOPPUUN                                       LOPPU                                           ;                                                                                                                               : AASU                                                            1 LEVEL ! 0                                                     BEGIN                                                             SANANEN LEVEL @ 0 <=                                          UNTIL                                                           1                                                             ;              \ VIEDAAN TYYPPI                                 \ Alkusulku ja Hanta                                            : (                                                               AASU STATE @ IF [COMPILE] DLITERAL                                           THEN                                             ;                                       IMMEDIATE               : STRING-HANTA                  \ REF , REF                       DUP IF STRI POBEG +                                                    DUP C@ DUP DUP 1 >                                              IF STRI SWAP GETN                                                  1- DUP STRI ACTIVE C!                                           SWAP 2+ OVER                                                    STRI ACTIVE 1+ SWAP CMOVE                                       1+ STRI @ SWAP                                                  STRI +!                                                      ELSE DROP 2DROP 0 THEN                                       THEN ;                                                    \ Kopiointi                                   20.4.86-HPU                                                                       : COPY-STRING                       \ OFF , OFF                   -DUP IF STRI POBEG + DUP C@       \ SAD KPL                             STRI OVER 1+ GETN                                               SWAP OVER 1+              \ KPL SAD KPL+1                       STRI ACTIVE SWAP CMOVE    \ KPL                                 STRI @ SWAP 1+                                                  STRI +! THEN                                          ;                                                                                                                               DEFER COPY-LIST                                                                                                                                                                                                                                                                                                                 \ Stringin p{{                                20.4.86-HPU                                                                       DEFER COPY-LIST                                                                                                                 : STRING-PAA                    \ REF , REF                       DUP IF                                                              STRI POBEG + 1+ C@                                              STRI 2 GETN STRI ACTIVE DUP                                     1 SWAP C! 1+ C!                                                 STRI @ DUP 2+ STRI !                                        THEN                                                          ;                                                                                                                                                                                                                                                                                                                               \ LIS{{ KOPIOINTIA                            16.3.86-HPU       HEX                                                             : MAKECOPY                      \ 0 SOUOFF KPL , 0 COFF COFF      0 ?DO                                                              SEURAAVA                                                        DUP LIS POBEG + @                                               DUP 8000 AND IF COPY-LIST                                                    ELSE COPY-STRING                                                THEN                                               SWAP                                                         LOOP                                                            DROP                                                          ;                                                               DECIMAL                                                                                                                         : PPEL ." PINON P[[ EI OLE LISTA TAI ALKIO " CR ;               \ LIS{{ kopiointia                                              HEX                                                             : PUTBACK                       \ 0 COFF COFF ... , REF           0 $KPL ! LIS 4 GETN                                             BEGIN                                                             -DUP WHILE                                                      LIS ACTIVE !                                                    LIS @ 2+ LIS !                                                  $KPL 1+!                                                        NEXTLIS                                                       REPEAT                                                          $KPL @ 8000 OR                                                  LIS ACTIVE !                                                    LIS @ DUP 2+ LIS !                                              8000 OR LEVEL 1-!                                             ; DECIMAL                                                       \ Lista rek. kopiointi                        16.3.86-HPU       HEX                                                             : (COPY-LIST)                   \ REF , REF                       DUP 8000 <> IF                \ KOPIO VAIN EI TYHJ{ST{                         0 SWAP 3FFF AND                                                 DUP LIS POBEG + @                                               3FFF AND MAKECOPY PUTBACK                                    THEN ;                                             ' (COPY-LIST) IS COPY-LIST                                                                                                     : $COPY                         \ REF TYPE , REF TYPE             JOS 1 NIIN COPY-LIST   1 LOPPUUN                                    4 NIIN COPY-STRING 4 LOPPUUN                                      ELLEI DROP PPEL LOPPU                                   ; DECIMAL                                                                                                                       \ Mik{ on                                     >5.3.86-HPU       HEX                                                             : ?LIST                                 \ REF TYPE , 0 tai REF 1  DUP 1 = IF OVER 8000 AND                                                    IF OVER 3FFF AND -DUP                                                IF LIS POBEG + @ 3FFF AND                                             IF ELSE 2DROP 0 THEN                                      ELSE 2DROP 0 THEN                                          ELSE 2DROP 0 THEN                                            ELSE 2DROP 0 THEN                                    ;                                                               : LLAATU                                \ REF , REF TYPE          DUP 8000 AND IF 1                                                            ELSE 4 THEN ;                                                                                                                                                                    \ Etup{{                                      16.3.86-HPU       HEX                                                             : LIST-ETUPAA                   \ REF , REF                       1 ?LIST IF                                                              3FFF AND DUP                                                    LIS POBEG + @                                                   3FFF AND                                                        1- -DUP                                                         IF 0 -ROT                                                          MAKECOPY PUTBACK                                             ELSE DROP 8000                                                  THEN                                                          ELSE 8000               \ EMPTY LIST                            THEN                                                    ;                                                               DECIMAL                                                         \ Osalistoja                                  16.3.86-HPU       HEX                                                             : GO-LIST-END                   \ REF , OFF                       3FFF AND DUP LIS POBEG + @                                      3FFF AND 0 ?DO SEURAAVA LOOP                                  ;                                                               : LIST-HANTA                    \ REF , REF TYPE                  1 ?LIST IF                                                               3FFF AND DUP LIS POBEG +                                        @ 3FFF AND 1-                                                   -DUP IF SWAP SEURAAVA SWAP 0                                            -ROT MAKECOPY PUTBACK                                        ELSE DROP 8000 THEN                                     ELSE 8000 THEN                                          ;                                                                 DECIMAL                                                       \ P{{                                         16.3.86-HPU       HEX                                                             : LIST-PAA                      \ REF , REF TYPE                  1 ?LIST IF                                                               3FFF AND SEURAAVA                                               LIS POBEG + @                                                   LLAATU $COPY                                                   ELSE 0 4                                                        THEN                                                  ;                                                               : P[[                               \ REF TYPE , REF TYPE         JOS 1 NIIN LIST-PAA     LOPPUUN                                     4 NIIN STRING-PAA 4 LOPPUUN                                           ELLEI PPEL             LOPPU                        ;                                                               DECIMAL                                                         \ Lis{{ NIL-pois                              20.4.86-HPU       HEX                                                             : STRING-ETUPAA                                                   DUP IF                                                                 STRI POBEG + DUP C@ DUP 1 >                                     IF                                                                  STRI OVER GETN                                                  SWAP STRI ACTIVE 3 PICK CMOVE                                   STRI ACTIVE DUP C@ 1- SWAP C!                                   STRI @ SWAP STRI +!                                         ELSE                                                                2DROP 0                                                     THEN                                                         THEN                                                      ;                                                               DECIMAL                                                         \ Lis{{ operaatioita                          >6.3.86-HPU       HEX                                                             : H[NT[                                 \ REF TYPE , REF TYPE     JOS 1 NIIN LIST-HANTA   1 LOPPUUN                                   4 NIIN STRING-HANTA 4 LOPPUUN                                     ELLEI PPEL LOPPU                                        ;                                                                                                                               : ALKUP[[                               \ REF TYPE , REF TYPE     JOS 1 NIIN LIST-ETUPAA   1 LOPPUUN                                  4 NIIN STRING-ETUPAA 4 LOPPUUN                                    ELLEI PPEL LOPPU                                        ;                                                                                                                                                                                                                                                               \ Listan tuhoamisen apuja                                       HEX                                                             : 0KULJE                                \ LINKKIOFFSET , OFF         LIS POBEG +                        \ ADDR OF LINK               DUP @ 3FFF AND                     \ ADRR LINKOFF               0 ROT !                            \ OFF                   ;                                                                                                                               : 0SEURAAVA                             \ OFF , OFF               2-                                                              BEGIN                                                              DUP LIS POBEG +                                                 @ 4000 AND                                                      WHILE 0KULJE REPEAT                                        ;                                                               DEFER FREE-LIST DECIMAL                                         \ Nollausta                                                     HEX                                                             : FREE-STRING                           \ OFF , -                 ?DUP IF STRI POBEG + DUP C@ 1+ 0 FILL THEN                    ;                                                               : (FREE-LIST)                           \ OFF KPL , -             0 ?DO 0SEURAAVA                                                      DUP LIS POBEG +                                                 DUP @ SWAP 0 SWAP !                                             DUP 8000 AND IF   FREE-LIST                                                  ELSE FREE-STRING                                                THEN                                          LOOP                                                            DROP                                                          ;                                                               DECIMAL                                                         \ Lis{{                                                         HEX                                                             : FREE-MA                                       \ OFF , -         3FFF AND ?DUP IF DUP                                                             LIS POBEG +                                                     DUP @ SWAP 0 SWAP !                                             3FFF AND (FREE-LIST)                           THEN ;                                                                                                                        ' FREE-MA IS FREE-LIST                                                                                                          : TUHOA                                         \ REF TYPE , ---  JOS 1 NIIN FREE-MA     LOPPUUN                                      4 NIIN FREE-STRING LOPPUUN                                        ELLEI PPEL DROP  LOPPU                                  ; DECIMAL                                                       \ Lis{{                                                         HEX                                                             : KPL                                   \ REF TYPE , N            JOS 1 NIIN 3FFF AND LIS POBEG +                                            @ 3FFF AND 0                 LOPPUUN                     4 NIIN DUP IF STRI POBEG + C@ THEN                                     0                            LOPPUUN                      ELLEI PPEL DROP                    LOPPU                 ;                                                                                                                               : PTEL                                                            ." PINO TOINEN EI OLE LISTA EIK[ ALKIO " CR ;                 DECIMAL                                                                                                                                                                                                                                                         \ OHHOH                                       >5.3.86-HPU       HEX                                                             : STRING-PAAKSI                         \ OFF , OFF               DUP STRI POBEG + C@                                             2 PICK STRI POBEG + C@                                          + STRI OVER GETN                                                STRI ACTIVE C!                                                  STRI POBEG + DUP C@ DUP >R                                      SWAP 1+ STRI ACTIVE 1+ ROT CMOVE                                STRI POBEG + DUP C@                                             SWAP 1+ STRI ACTIVE R> + 1+ ROT CMOVE                           STRI ACTIVE C@ 1+ STRI @                                        SWAP STRI +!                                                  ;                                                                                                                                                                                               \ OHHOH OHHOH                                                   HEX                                                             : LIST-PAAKSI                   \ REF REF , REF TYPE              COPY-LIST SWAP COPY-LIST SWAP \ KOPIOINTI, ETTEIV{T MUUTU       OVER 8000 <> IF DUP GO-LIST-END                                                 ROT 7FFF AND                                                    DUP LIS POBEG +                                                 DUP @ >R                                                        2 PICK LIS POBEG +                                              @ SWAP !                                                        4000 OR                                                         SWAP LIS POBEG +                                                ! DUP 7FFF AND                                                  LIS POBEG + R> !+ 1                                        ELSE SWAP DROP THEN  \ TYHJ{ POIS                  ; DECIMAL                                                       \ P{{ksi                                      >17.3.86-HPU      HEX                                                             : P[[KSI RECURSIVE      \ REF TYPE REF TYPE , REF TYPE            DUP 1 =                                                         IF DROP SWAP 1 =                                                       IF DUP 8000 <> IF   LIST-PAAKSI  \ TYHJA OHITETAAN                             ELSE DROP 1 THEN                                 ELSE PTEL                                                       THEN                                                     ELSE                                                               4 = IF -DUP IF 0 SWAP PUTBACK 1 P{{KSI \ TEHD{{N LISTAKSI                   ELSE DROP 2DROP PPEL                                            THEN                                                    THEN                                                     THEN                                                          ; DECIMAL                                                       \ Lis{{                                                         HEX                                                                                                                             : PER[[N                        \ ref ref , ref                   DUP 4 = IF DROP 0 SWAP PUTBACK 1 THEN                           2SWAP P[[KSI ;                                                                                                                : LIST-PERA                     \ REF , REF TYPE                  DUP 3FFF AND LIS POBEG + @ 3FFF AND                             IF GO-LIST-END                \ TYHJ{ LISTA ERIKSEEN               LIS POBEG + @                                                   LLAATU $COPY                                                 ELSE DROP 0 4                                                   THEN                                                          ;                                                               DECIMAL                                                         \ Lis{{                                       20.4.86-HPU       HEX                                                             : STRING-PERA                                                     DUP IF                                                                 STRI POBEG + DUP C@                                             + C@                                                            STRI 2 GETN                                                     STRI ACTIVE DUP                                                 1 SWAP C! 1+ C!                                                 STRI @ DUP 2+ STRI !                                     THEN                                                          ;                                                                                                                               : KOPIO                         \ REF , REF REF                   2DUP $COPY ;  DECIMAL                                                                                                         \ Per{                                        20.4.86-HPU       HEX                                                                                                                             : PER[                          \ REF TYPE , REF TYPE             JOS 1 NIIN LIST-PERA     LOPPUUN                                    4 NIIN STRING-PERA 4 LOPPUUN                                ELLEI PPEL               LOPPU                                ;                                                               DECIMAL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ Per{                                                          HEX                                                             : LIIT{   JOS                   | REF TYPE REF TYPE , REF TYPE    1 NIIN SWAP 1 =                                                        IF 0 -ROT PUTBACK 1                                             ELSE 2DROP PTEL THEN    LOPPUUN                          4 NIIN                                                                DUP IF SWAP 4 =                                                        IF   SWAP DUP                                                        IF   SWAP STRING-PAAKSI 4                                       ELSE DROP 4 THEN                                           ELSE 2DROP ." Pinossa ei kaksi alkiota" THEN                 ELSE DROP THEN       LOPPUUN                          ELLEI DROP 2DROP PPEL          LOPPU                          ;                                                                 DECIMAL                                                       \ Lis{{ listasanoja                           >17.3.86-HPU      : LISTA?                                                          SWAP DROP 1 = DUP                                             ;                                                               : ALKIO?                                                          SWAP DROP 4 = DUP                                             ;                                                               VARIABLE LFLAG                                                                                                                  : ASAMAT                                     \ AREF AREF , -      STRI POBEG + SWAP STRI POBEG +                                  OVER C@ OVER C@ OVER                       \ REF REF N N N      = IF 0 ?DO 1+ SWAP 1+ OVER C@ OVER C@                                      <> IF LFLAG OFF LEAVE THEN LOOP                        ELSE DROP LFLAG OFF                                             THEN 2DROP ;                                                \ Listojen yht{suuruus                                                                                                          DEFER LSAMAT    HEX                                                                                                             : NSAMAT                        \ REF REF N , -                   0 ?DO SEURAAVA SWAP SEURAAVA                                          OVER LIS POBEG + @                                              OVER LIS POBEG + @ LSAMAT                                       LFLAG @ IF ELSE LEAVE THEN                                LOOP 2DROP                                                    ;                                                               : SLKPL                 \ REF REF , N N N                         3FFF AND LIS POBEG + C@ SWAP                                    3FFF AND LIS POBEG + C@                                         OVER                                                          ;                                                               \ Listojen yht{suuruus                                                                                                          : (LSAMAT)                      \ REF REF , -                     OVER 8000 AND OVER 8000 AND OVER                                = IF                                                                 IF 2DUP SLKPL =                                                              IF   ROT 3FFF AND ROT 3FFF AND                                       ROT NSAMAT                                                 ELSE DROP 2DROP LFLAG OFF                                       THEN                                               ELSE ASAMAT                                                     THEN                                                          ELSE DROP 2DROP LFLAG OFF                                       THEN                                                       ;                                                               ' (LSAMAT) IS LSAMAT                                            \ Listojen yht{suuruus                                          : =$                            \ REF TYPE REF TYPE , F           ROT = IF LFLAG ON LSAMAT LFLAG @                                      ELSE 0 THEN DUP                                         ;                                                               HEX                                                             : KUULUU?                             \ REF LI REF AL , F         LFLAG OFF 4 =                                                   IF SWAP 1 =                                                          IF SWAP 3FFF AND DUP LIS POBEG + C@    \ A L N                        0 ?DO LFLAG ON SEURAAVA OVER OVER LIS POBEG + @                       ASAMAT LFLAG @ IF LEAVE THEN LOOP                   THEN                                                       ELSE DROP THEN                                                  2DROP LFLAG @ DUP    ;                                        DECIMAL                                                         \ samat                                                         : samat?                                                          dup jos 1 niin =$ loppuun                                               4 niin =$ loppuun                                           ellei ppel    loppu                                       ;                                                               : asciiksi                                                        drop stri pobeg +                                               1+ c@ 0                                                       ;                                                               : merkiksi                                                        fix drop stri 2 getn                                            stri active 1 over c!                                           1+ c! stri @                                                    2 stri +! 4                                                   ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               