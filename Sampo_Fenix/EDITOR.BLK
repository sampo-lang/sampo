                                              >6.3.86-HPU                                                                          EEEEEE   DDDD     I  TTTTTTT                                    E        D   D    I     T                                       E        D    D   I     T                                       EEEE     D    D   I     T                                       E        D    D   I     T                                       E        D   D    I     T                                       EEEEEE   DDDD     I     T                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \ Sampon systeemimuutokset                                    hp                                                                 CR .( EDITOR ALKAA )                                                                                                           23 CONSTANT SCLINES     | LINES ON THE SCREEN -1                                                                                VARIABLE XCU VARIABLE YCU VARIABLE KULMA VARIABLE ?PINO         1 ?PINO !                                                                                                                       hex                                                             : kursori_pois 100 0 2607 0 vidio 2drop 2drop ;                 decimal                                                                                                                         1 33 +THRU CR .( EDIT MENI )                                                                                                                                                                       \  PATCH                                                   hpHEX  123 CONSTANT NEST         \ Entinen DOCOLON                : OTA-BODYT                                                       [COMPILE] ' [COMPILE] ' ;                                     : PATCH                                                           OTA-BODYT                                                       DUP @ HEX NEST = IF                                              2 + DUP -ROT !                                                  ['] UNNEST SWAP 2 + !                                          ELSE ." VIKA"                                                   THEN ;                                                        : (NAYTA) BASE @ DUP DECIMAL . XCU @ . YCU @ . KULMA @ .          BASE !                                                          CONTEXT @ BODY> >NAME .ID .S 60 SPACES                          ; DECIMAL                                                     DEFER NAYTA                                                     \ Tilan n„ytt„v„ QUIt                                         hp                                                                VARIABLE RECLEVEL       VOCABULARY EDITOR                                                                                       : JOSFORTHNAYTA                                                   CONTEXT @ 2 - ['] EDITOR <> IF                                    ?PINO @ IF 0 0 IBM-AT NAYTA 0 SCLINES IBM-AT THEN THEN      ;                                                               : SQUIT   (S -- )                                                  RECLEVEL OFF                                                    SP0 @ 'TIB !    BLK OFF   [COMPILE] [                           BEGIN RP0 @ RP! STATUS JOSFORTHNAYTA QUERY RUN                     STATE @ NOT IF   ."  ok"   THEN                              AGAIN ;                                                      ' (NAYTA) IS NAYTA                                                                                                              \                                             >6.3.86-HPU     hp : % DECIMAL ; IMMEDIATE %                                                                                                       : ENDIF [COMPILE] THEN ; IMMEDIATE                                                                                             VARIABLE &EID 20 ALLOT                                                                                                          &EID 20 BLANK                                                                                                                   : RAW-KEY KEY ;                                                                                                                 : -DUP DUP IF DUP THEN ;                                                                                                                                                                                                                                                                                                        \ luodaan editori                                   HPU                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \ EDITOR SCREEN 1       JOS                12.2.86-HPU     hp   VARIABLE JOSSP                                                  : JOS SP@ JOSSP ! ; IMMEDIATE                                   : NIIN                                                               COMPILE OVER COMPILE =                                          COMPILE ?BRANCH ?>MARK                                          COMPILE DROP ; IMMEDIATE                                   : LOPPUUN                                                            COMPILE BRANCH ?>MARK                                           2SWAP ?>RESOLVE ; IMMEDIATE                                : ELLEI                                                             COMPILE DROP 0 ; IMMEDIATE                                  : LOPPU                                                             DUP IF COMPILE DROP ELSE DROP THEN                              BEGIN SP@ JOSSP @ <> WHILE                                      ?>RESOLVE REPEAT ; IMMEDIATE                                \ EDITOR SCREEN 2      VARIABLES                 HPU       PU                                                                EDITOR ALSO DEFINITIONS                                                                                                             VARIABLE &MODE                                                  VARIABLE &CURSOR                                                VARIABLE &OLD-MODE                                              VARIABLE &UPDATE                                                VARIABLE &BUF-ADR                                               VARIABLE LINE-BUFFER 64 ALLOT  \  Used by DELETE-LINE )         VARIABLE OVERRUN      \ Used by INSERT-CHAR )                                                                                                                                                                                                                                                                                                                                                  \ EDITOR SCREEN 3      VARIABLES         BOB 5-AUG229jan86 hp   5 CONSTANT %X-OFF                                               2 CONSTANT %Y-OFF                                               B/BUF CONSTANT C/SCR                                             VARIABLE 'CRTXY                                                 VARIABLE 'CRTCLR-SCR                                            VARIABLE 'CLEAR-TO-EOL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ EDITOR SCREEN 14      CRT CALLS         BOB 5-AUG28jan81HPU    :  CRTXY 'CRTXY @ EXECUTE ;                                     :  CRTCLR-SCR  'CRTCLR-SCR @ EXECUTE ;                          :  CLEAR-TO-EOL 'CLEAR-TO-EOL @ EXECUTE ;                       :  CURPOS  &CURSOR @ ;                                          :  +CURPOS  &CURSOR +! CURPOS 0 MAX                                    [ C/SCR 1- ] LITERAL MIN &CURSOR ! ;                     :  MOVE-CURSOR  +CURPOS CURPOS C/L /MOD %Y-OFF + SWAP %X-OFF + SWAP  CRTXY ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \ EDITOR SCREEN 15                        BOB 5-AUG28jan81HPU   :  BUF-ADR  &BUF-ADR @ + ;                                      :  BUFPOS  CURPOS BUF-ADR ;                                     :  E-UPDATE  1 &UPDATE ! ;                                      :  BUF-MOVE  ROT BUF-ADR  ROT BUF-ADR ROT MOVE E-UPDATE ;       :  ?PRINTABLE  DUP 32 < SWAP 126 > OR 0= ;                      :  >LINE#  C/L / ;                                              :  LINE#>  C/L * ;                                              :  CHARS-TO-EOL  C/L MOD C/L SWAP - ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \ EDITOR SCREEN 16      DISPLAY           BOB 5-AUG29jan86 hp :  DISPLAY-TO-EOL  DUP BUF-ADR OVER CHARS-TO-EOL  ROT                   OVER +                                                         DROP  TYPE ;                                               :  ?EMPTY-LINE  LINE#> BUF-ADR C/L -TRAILING SWAP DROP 0= ;     :  DISPLAY-TO-EOS  CURPOS                                           SWAP L/SCR SWAP DO I LINE#> DUP &CURSOR !                       0 MOVE-CURSOR DISPLAY-TO-EOL LOOP                                &CURSOR !  0 MOVE-CURSOR ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 \ EDITOR SCREEN 17      EXPAND / SHRINK   BOB 5-AUG29jan86 hp    :  EXPAND  DUP DUP C/L + C/SCR OVER -                                  BUF-MOVE BUF-ADR C/L BLANK E-UPDATE ;                    :  SHRINK  DUP C/L + SWAP OVER C/SCR                                   SWAP - BUF-MOVE [ L/SCR 1- ] LITERAL                        LINE#> BUF-ADR C/L BLANK E-UPDATE ;                          :  INSERT-LINE  [ L/SCR 1- ] LITERAL                                   ?EMPTY-LINE IF DUP EXPAND >LINE#                            DISPLAY-TO-EOS                                                      ELSE BEEP ENDIF ;                                                                                                                                                                                                                                                                                                                                                                                                                                       \ EDITOR SCREEN 18      INSERT CHAR       BOB 09/1929jan86 hp   : SCAN-2BL      (S ADDR --- # ) \ Returns the number of )               0 SWAP                  \ chars to a double space )             BUF-ADR C/SCR 1- BUF-ADR SWAP DO                                        I C@ BL = IF                                                            I 1+ C@ BL = IF                                                         DROP I 1+ LEAVE                                         THEN                                                    THEN    LOOP ;                                : INS-CHAR ( CHAR POS --- )                                       DUP DUP 1+ OVER SCAN-2BL -DUP IF                                  BUFPOS - DUP CURPOS C/L MOD + C/L / OVERRUN !                   BUF-MOVE BUF-ADR C!                                           ELSE BEEP DROP DROP DROP DROP THEN ;                                                                                                                                                            \ EDITOR SCREEN 20      DELETE            BOB 5-AUG28jan81HPU   :  DELETE-LINE  >LINE# DUP LINE#> DUP BUF-ADR LINE-BUFFER               64 CMOVE SHRINK DISPLAY-TO-EOS ;                        :  DEL-CHAR  DUP DUP 1+ SWAP OVER CHARS-TO-EOL                          BUF-MOVE DUP CHARS-TO-EOL +                                 1- BUF-ADR BL SWAP C! ;                                     : R-ARROW  1 +CURPOS ;                                          : L-ARROW  -1 +CURPOS ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ EDITOR SCREEN 21      YANK-BACK         BOB 5-AUG29jan86 hp   : YANK-BACK     (S --- )                                                [ L/SCR 1- ] LITERAL ?EMPTY-LINE IF DUP EXPAND                          >LINE# DUP LINE#> BUF-ADR LINE-BUFFER SWAP                      64 CMOVE DISPLAY-TO-EOS                                ELSE BEEP  THEN ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \ EDITOR SCREEN 22      COMMANDS          BOB 5-AUG29jan86 hp   : U-ARROW  C/L NEGATE +CURPOS ;                                 : D-ARROW  C/L +CURPOS ;                                        : I-LINE  CURPOS INSERT-LINE ;                                  : D-LINE  CURPOS DELETE-LINE ;                                  : Y-BACK CURPOS YANK-BACK ;                                     : D-CHAR  CURPOS DEL-CHAR CURPOS DISPLAY-TO-EOL ;               : INSERT-MODE  1 &MODE CTOGGLE ;                                : RETURN  CURPOS >LINE# 1+ [ L/SCR 1- ] LITERAL                         MIN LINE#> &CURSOR ! ;                                                                                                                                                                                                                                                                                                                                                                                                                                  \ EDITOR SCREEN 23      COMMANDS                           hp                                                                   : EXIT-EDIT CR R> DROP R>                                           DROP R> DROP R> DROP R> DROP ;                                                                                              : EXIT-UPDATE  C/SCR MOVE-CURSOR CR CR SCR @ .                          &UPDATE @ IF                                                        &EID [ C/L 22 - ] LITERAL BUF-ADR 20 CMOVE                      ." Korjattu" UPDATE FLUSH                                   ELSE                                                                ." Ei muutoksia"                                            ENDIF EXIT-EDIT ;                                                                                                                                                                                                                                                                                                    \ EDITOR SCREEN 24      COMMANDS                                                                                                : EXIT-SCRATCH  C/SCR MOVE-CURSOR                                 CR CR SCR ? ." Korjaukset hyl{tty"                              EMPTY-BUFFERS EXIT-EDIT ;                                                                                                     : E-TAB 8 CURPOS 8 MOD - +CURPOS ;                                                                                              : SCAN+=  2DUP = IF DROP 2DROP 0                                  ELSE 0 ROT ROT DO OVER I C@ = IF LEAVE                          ELSE 1+ ENDIF LOOP SWAP DROP ENDIF ;                                                                                          : SCAN+<> 2DUP = IF DROP 2DROP 0                                  ELSE 0 ROT ROT DO OVER I C@ <>                                  IF LEAVE ELSE 1+ ENDIF LOOP                                     SWAP DROP ENDIF ;                                                \ EDITOR SCREEN 25      COMMANDS          BOB 5-AUG29jan86 hp   : SCAN-= 2DUP = IF DROP 2DROP 0                                         ELSE 0 ROT ROT DO OVER I C@ = IF LEAVE                     ELSE 1- ENDIF -1 +LOOP SWAP DROP ENDIF ;                     : SCAN-<> 2DUP = IF DROP 2DROP 0                                        ELSE 0 ROT ROT DO OVER I C@ <> IF LEAVE                    ELSE 1- ENDIF -1 +LOOP SWAP DROP ENDIF ;                     : MOVE-LEFT-WORD  BL 0 BUF-ADR BUFPOS SCAN-=                            >R BL 0 BUF-ADR BUFPOS R@ +                                     SCAN-<> R> + >R BL 0 BUF-ADR BUFPOS R@ +                        SCAN-=  R> + DUP BUFPOS + C@ BL = IF 1+ ENDIF ;                                                                                                                                                                                                                                                                                                                                         \ EDITOR SCREEN 26      COMMANDS          BOB 5-AUG29jan86 hp   : MOVE-RIGHT-WORD BL [ C/SCR 1- ] LITERAL                               BUF-ADR BUFPOS SCAN+= >R BL                                [ C/SCR 1- ] LITERAL BUF-ADR BUFPOS                                  R@ + SCAN+<> R> + ;                                     : R-WORD  MOVE-RIGHT-WORD +CURPOS ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ EDITOR SCREEN 27      COMMANDS          BOB 5-AUG29jan86 hp    : L-WORD  MOVE-LEFT-WORD +CURPOS ;                              : DEL-CHARS  2DUP + OVER DUP CHARS-TO-EOL                              BUF-MOVE DUP CHARS-TO-EOL +                                OVER - BUF-ADR SWAP BLANK ;                                   : D-WORD  MOVE-RIGHT-WORD CURPOS                                       BUF-ADR CURPOS CHARS-TO-EOL -TRAILING SWAP                 DROP MIN CURPOS DEL-CHARS CURPOS DISPLAY-TO-EOL ;             : U-TAB 4 C/L * NEGATE +CURPOS ;                               : PRINT-SCR     (S --- ) \ PRINTS OUT THE SCREEN )            ;                                                                                                                                                                                                                                                                                                                                                                                                 \ EDITOR SCREEN 28      COMMANDS           >17.3.86-HPU    hp    : D-TAB 4 C/L * +CURPOS ;                                       : CLR-SCREEN 0 &CURSOR ! CURPOS                                        BUF-ADR C/SCR BLANK 0 DISPLAY-TO-EOS                       E-UPDATE ;                                                    : DISPLAY-STATUS  &MODE @ &OLD-MODE @                                  <> IF 40 0 CRTXY &MODE @ IF ." Lis{ystila"                 ELSE 10 SPACES ENDIF &MODE @ &OLD-MODE ! ENDIF                       CURPOS C/L /MOD 35 0 CRTXY 2 .R                                 28 0 CRTXY 2 .R ;                                                                                                                                                                                                                                                                                                                                                                                                                                       \ EDITOR SCREEN 29      COMMANDS                           hp    : CLR-LINE  CURPOS DUP >LINE# LINE#>                                   &CURSOR ! CURPOS BUF-ADR C/L BLANK                              E-UPDATE 0 MOVE-CURSOR                                          64 SPACES                                                       &CURSOR ! 0 MOVE-CURSOR ;                               : DELETE-KEY  (S --- )                                                  L-ARROW 0 MOVE-CURSOR                                           BL BUFPOS C! BL EMIT                                            ;                                                                                                                                                                                                                                                                                                                                                                                                                                                       \ EDITOR SCREEN 30      HELP                               hp: HELP (S --- ) CRTCLR-SCR ." NAPPAINTEN TOIMINTA: " CR CR      ." Nuolin{pp{imet siirt{v{t kursoria, lis{ksi seuraavat: " CR   ." PGUP        4 Rivi{ yl|s    PGDN        4 Rivi{ alas   " CR  ." CTRL OIKEA  Sana oikealle   CNTRL VASEN Sana vasemmalle" CR  ." HOME        Poista merkki   BS          Poista edellinen"    CR ." INS         Lis{ys/P{{llekirjoitus "                       CR CR ." Rivien korjailu:" CR                                  ." CTRL HOME   Poista rivi     CTRL PGUP   Palauta rivi " CR    ." DEL         Tyhjenn{ rivi   CTRL PGDN   Lis{{ tyhj{ rivi " CR CR ." Koko ruudun komennot:" CR CR                             ." CTRL END    Tyhjenn{ ruutu  CNTRL ENTER Lopeta ESC kesk. "     CR CR ." Mika tahansa merkki palauttaa takaisin" KEY           DROP  CRTCLR-SCR  0 %Y-OFF CRTXY L/SCR 0 DO I 3 .R CR LOOP        10 0 CRTXY ." SCR:" SCR @ 4 .R 6 SPACES ." X=     Y="          CR 15 SPACES ." Neuvoja CTRL/Q:lla "  0 DISPLAY-TO-EOS ;         \ EDITOR SCREEN 31      CONTROL-CHAR       >17.3.86-HPU    hp   :  CONTROL-CHAR %     JOS  ( KOODI --- )                       13 NIIN RETURN      LOPPUUN    115 NIIN L-WORD       LOPPUUN    09 NIIN E-TAB       LOPPUUN    132 NIIN Y-BACK       LOPPUUN    08 NIIN DELETE-KEY  LOPPUUN    116 NIIN R-WORD       LOPPUUN    72 NIIN U-ARROW     LOPPUUN    127 NIIN D-WORD       LOPPUUN    80 NIIN D-ARROW     LOPPUUN     71 NIIN D-CHAR       LOPPUUN    75 NIIN L-ARROW     LOPPUUN     81 NIIN D-TAB        LOPPUUN    77 NIIN R-ARROW     LOPPUUN     83 NIIN CLR-LINE     LOPPUUN    82 NIIN INSERT-MODE LOPPUUN     10 NIIN EXIT-UPDATE  LOPPUUN    73 NIIN U-TAB       LOPPUUN    118 NIIN I-LINE       LOPPUUN   117 NIIN CLR-SCREEN  LOPPUUN     27 NIIN EXIT-SCRATCH LOPPUUN   119 NIIN D-LINE      LOPPUUN     75 NIIN L-ARROW      LOPPUUN    17 NIIN HELP        LOPPUUN     16 NIIN PRINT-SCR    LOPPUUN       ELLEI BEEP       LOPPU ;                                                                                                   \                                                     29jan86 hp : E-OVERSTRIKE                                                    RAW-KEY DUP IF                                                      DUP ?PRINTABLE IF                                                  DUP EMIT BUFPOS C! E-UPDATE 1 +CURPOS                           ELSE CONTROL-CHAR ENDIF                                      ELSE DROP KEY CONTROL-CHAR ENDIF ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \                                                    29jan86 hp : E-INSERT RAW-KEY DUP IF                                           DUP ?PRINTABLE IF                                                    CURPOS INS-CHAR CURPOS DISPLAY-TO-EOL                           OVERRUN @ -DUP IF CURPOS SWAP OVER >LINE# 1+ SWAP               OVER + SWAP DO I LINE#> DUP &CURSOR ! 0 MOVE-CURSOR             DISPLAY-TO-EOL LOOP &CURSOR ! THEN                              1 +CURPOS                                                    ELSE CONTROL-CHAR ENDIF                                       ELSE DROP RAW-KEY CONTROL-CHAR ENDIF ;                                                                                                                                                                                                                                                                                                                                                                                                                     \                                                             hp    :  E-INIT  DEPTH IF SCR ! ENDIF  SCR @ BLOCK                           &BUF-ADR !  CRTCLR-SCR 0 &MODE !                                0 &CURSOR ! 0 &UPDATE ! 0 %Y-OFF CRTXY                          L/SCR 0 DO I 3 .R CR LOOP 10 0 CRTXY                            ." SCR: " SCR @ 4 .R 6 SPACES ." X=    Y="                      CR 19 SPACES ." Neuvoja CTRL/Q:lla " 0 DISPLAY-TO-EOS       kursori_pois                                              ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              \ Cursor Routines for IBM PC Bios                             hp                                                                   ' IBM-AT    'CRTXY       !                                      ' IBM-DARK  'CRTCLR-SCR  !                                      ' IBM-BLOT  'CLEAR-TO-EOL !                                                                                                                                                                  DEFER SCROLL                                                    DEFER BSPEISI                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \ Ruudullekirjoitus                                             HEX FORTH DEFINITIONS                                           VARIABLE VIERIT SCLINES 1 - VIERIT ! EDITOR DEFINITIONS         : CO(SCROLL)                            ( - , - )                 184F SCLINES VIERIT @ - 100 * 0 601 VIDIO40 ;                 : BELLI                                 ( - , - )                 07 6 BDOS DROP ;                                              : CO(BSPEISI)                           ( - , - )                 VIDIO02 -DUP IF 1- VIDIO20C 20 VIDIO10CHA THEN ;              : ?SCROLL                               ( RIVI SAR , -)           DUP      4F > IF DROP 1+ 0 THEN                                 SWAP DUP SCLINES > IF SCROLL 1- THEN                            SWAP VIDIO20C ;                                               : RETURNI                               ( - , - )                 VIDIO02 DROP 1+ 0 ?SCROLL ;                                   DECIMAL                                                         \ Ruudullekirjoitus                                             \ Reik{ my|s TEE:n blokkikirjoitusta varten                                                                                     HEX                                                                                                                             : TAVALLINEN                                                      VIDIO10CHA VIDIO02 1+ ?SCROLL                                 ;                                                                                                                               : TABBI                                                           VIDIO02 8 OVER 8 MOD - + ?SCROLL ;                                                                                            defer S(HERCU)             \ Varaudutaan grafiikkaruutuun                                                                       ' NOOP is S(HERCU)                                                                                                              \ Ruudullekirjoitus                                             HEX   : +OUT 1 #OUT +! ;                                        : S(CONSOLE)  S(HERCU)          \ CHAR , - )                      JOS 07 NIIN BELLI         LOPPUUN                                   08 NIIN BSPEISI       LOPPUUN                                   09 NIIN TABBI         LOPPUUN                                   0A NIIN               LOPPUUN                                   0D NIIN RETURNI       LOPPUUN                                   5B NIIN 8E TAVALLINEN +OUT LOPPUUN \ AAA                        5C NIIN 99 TAVALLINEN +OUT LOPPUUN \ OO                         5D NIIN 8F TAVALLINEN +OUT LOPPUUN \ R AA                       7B NIIN 84 TAVALLINEN +OUT LOPPUUN                              7C NIIN 94 TAVALLINEN +OUT LOPPUUN                              7D NIIN 86 TAVALLINEN +OUT LOPPUUN                             DUP TAVALLINEN +OUT  LOPPU ;                               DECIMAL                                                         \ Graafinen vilkkukursori                                       HEX    .( scr 33  ) cr                                          \ t{m{ curso ei ole k{yt\ss{ Sampossa vaan kurso grkurso.blk:staDEFER (THERCU)  ' NOOP IS (THERCU)                              : CURSO                                                           0FE (THERCU) DROP                                               20  (THERCU) DROP                                             ;                                                               : S(KEY)                                                                                                                          BEGIN CURSO     \ CURSO WAITO CURSO WAITO WAITO                 (KEY?) UNTIL                                                    0 8 BDOS ;                                                    DECIMAL                                                                                                                                                                                                                                                         FORTH DEFINITIONS                                               : EDIT                                                             E-INIT                                                         BEGIN                                                             DISPLAY-STATUS 0 MOVE-CURSOR &MODE @                            IF   E-INSERT                                                   ELSE E-OVERSTRIKE                                               ENDIF                                                         AGAIN ;                                                                                                                       : SET-DATE 32 WORD DUP  1+ SWAP &EID 4 + SWAP                     C@ CMOVE ;                                                                                                                    : NE SCR @ 1+ EDIT ;                                            : BE SCR @ 1- EDIT ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Suomalainen case                                      28jan81HPUMalli otettu Dr Dobbs:n journalissa KAYPRO:a varten tehdyst„    CASE:sta esimerkki                                                                                                              JOS kytkin                                                      x NIIN oper oper ... LOPPUUN                                    y NIIN oper oper ... LOPPUUN                                    ELLEI oper oper oper                                            LOPPU                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           